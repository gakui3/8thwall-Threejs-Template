(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&u(n)}).observe(document,{childList:!0,subtree:!0});function h(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(e){if(e.ep)return;e.ep=!0;const o=h(e);fetch(e.href,o)}})();const f=()=>{let a,s=!1;const h=()=>a,u=({canvas:n,canvasWidth:t,canvasHeight:r,GLctx:d})=>{if(s)return;const l=new THREE.Scene,i=new THREE.PerspectiveCamera(60,t/r,.01,1e3);l.add(i);const c=new THREE.WebGLRenderer({canvas:n,context:d,alpha:!0,antialias:!0});c.autoClear=!1,c.setSize(t,r),c.outputEncoding=THREE.sRGBEncoding,c.shadowMap.enabled=!0,c.shadowMap.type=THREE.PCFSoftShadowMap,a={scene:l,camera:i,renderer:c},s=!0,window.scene3=a,window.XR8.Threejs.xrScene=h},e=XR8.XrDevice.deviceEstimate(),o=e.os==="iOS"&&parseFloat(e.osVersion)>=15.4;return{name:"customthreejs",onStart:n=>u(n),onAttach:n=>u(n),onDetach:()=>{s=!1},onUpdate:({processCpuResult:n})=>{const t=n.reality||n.facecontroller;if(!t)return;const{rotation:r,position:d,intrinsics:l}=t,{camera:i}=a;for(let c=0;c<16;c++)i.projectionMatrix.elements[c]=l[c];i.projectionMatrixInverse&&(i.projectionMatrixInverse.invert?i.projectionMatrixInverse.copy(i.projectionMatrix).invert():i.projectionMatrixInverse.getInverse(i.projectionMatrix)),r&&i.setRotationFromQuaternion(r),d&&i.position.set(d.x,d.y,d.z)},onCanvasSizeChange:({canvasWidth:n,canvasHeight:t})=>{if(!s)return;const{renderer:r}=a;r.setSize(n,t)},onRender:()=>{const{scene:n,camera:t,renderer:r}=a;r.clearDepth(),o&&r.getContext().finish(),r.render(n,t)},xrScene:()=>a}},w=()=>{let a,s;const h=({scene:e,camera:o,renderer:n})=>{const t=new THREE.DirectionalLight(16777215,1);t.position.set(-1,4,-.5),t.castShadow=!0,o.position.set(0,3,0),e.add(t),e.add(new THREE.AmbientLight(4210752,2)),new GUI,s=new THREE.Raycaster,t.shadow.mapSize.width=4096,t.shadow.mapSize.height=4096,t.shadow.camera.near=.05,t.shadow.camera.far=100,t.shadow.camera.bottom=-15,t.shadow.camera.top=15,t.shadow.camera.left=-15,t.shadow.camera.right=15;const r=new THREE.Mesh(new THREE.PlaneGeometry(100,100,10,10),new THREE.ShadowMaterial({color:new THREE.Color(.1,.1,.1),opacity:.8,depthWrite:!1}));r.rotateX(-1.57),r.position.set(0,0,0),r.receiveShadow=!0,e.add(r);const d=new THREE.SphereGeometry(1,10,10),l=new THREE.MeshPhongMaterial({});l.flatShading=!0,l.skinning=!0;const i=new THREE.Mesh(d,l);i.castShadow=!0,i.receiveShadow=!0,i.position.set(0,2,-5),e.add(i)},u=e=>{if(e.touches.length===3&&GUI.toggleHide(),e.touches.length===1){const{camera:o}=XR8.Threejs.xrScene(),n=new THREE.Vector2(0,0);n.x=e.touches[0].clientX/window.innerWidth*2-1,n.y=-(e.touches[0].clientY/window.innerHeight)*2+1,s.setFromCamera(n,o);const t=s.intersectObject();t.length>0&&console.log(t[0].point)}};return{name:"threejsinitscene",onStart:async({canvas:e,canvasWidth:o,canvasHeight:n})=>{const{scene:t,camera:r}=XR8.Threejs.xrScene();h({scene:t,camera:r}),a=new THREE.Clock,a.start(),XR8.XrController.updateCameraProjectionMatrix({origin:r.position,facing:r.quaternion}),e.addEventListener("touchstart",u,!0)},onUpdate:()=>{}}},p=()=>{const a=document.getElementById("camerafeed");XR8.addCameraPipelineModules([XR8.GlTextureRenderer.pipelineModule(),f(),w(),XR8.XrController.pipelineModule(),XRExtras.AlmostThere.pipelineModule(),XRExtras.RuntimeError.pipelineModule(),XRExtras.FullWindowCanvas.pipelineModule()]),XR8.run({canvas:a})};window.onload=()=>{window.XR?p():window.addEventListener("xrloaded",p)};
